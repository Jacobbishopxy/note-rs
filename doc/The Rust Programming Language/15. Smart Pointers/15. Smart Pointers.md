# 智能指针

*指针*pointer 是一个包含内存地址的通用概念。这个地址指向一些其它数据。Rust 中最常见的指针是第四章讲到的引用。引用以`&`开头并借用了它们指向的值。除了引用数据以外没有其它任何特殊功能。同时，它们没有任何额外的开销，所以应用的最多。

另一方面，*智能指针*是一种数据结构，它不仅仅像指针而且还带有额外的元数据和功能。智能指针的概念并不是 Rust 独有的：起源于 C++并存在于其它语言。Rust 标准库提供了不同的智能指针。...

在 Rust 中，引用与智能指针的一个额外区别是引用只借用了它们指向的数据；相反的，很多情况下，智能指针拥有它们指向的数据。

...

智能指针通过使用结构体实现。与普通结构体不同的是，智能指针实现了`Deref`和`Drop`特性。`Deref`特性允许一个智能指针结构体实例的表现的像引用一样，这样可以编写即可用于引用又可用于智能指针的代码。`Drop`特性允许我们自定义当指针离开作用域时允许的代码。

智能指针是一个在 Rust 上经常被使用的通用设计模式，本章不会覆盖所有现有的智能指针。很多库有它们自己的智能指针，你也可以编写自己的智能指针。我们将讨论标准库中最常用的几个智能指针：

- `Box<T>`用于堆上分配值
- `Rc<T>`一个引用计数类型并允许多个拥有者
- `Ref<T>`和`RefMut<T>`，通过`RefCell<T>`访问，是一个在运行时而不是在编译时执行借用规则的类型

另外我们将覆盖*内部可变性*interior mutability 模式，它是不可变类型为了改变内部值而暴露一个 API。我们也会讨论*引用循环*reference cycles：它们会泄露内存并如何避免它们。
